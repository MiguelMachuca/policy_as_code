{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[14, "provider \"aws\" {\n"], [15, "  region = \"us-east-1\"\n"], [16, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [14, 16], "resource": "aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["acl", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "resource_type", "access_control_policy/grant"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["access_control_policy/grant/*/permission", "acl", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "resource_type", "access_control_policy/grant"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[42, "resource \"aws_s3_bucket_versioning\" \"secure_bucket_versioning\" {\n"], [43, "  bucket = aws_s3_bucket.secure_bucket.id\n"], [44, "  versioning_configuration {\n"], [45, "    status = \"Enabled\"\n"], [46, "  }\n"], [47, "}"]], "file_path": "/main.tf", "file_line_range": [42, 47], "resource": "aws_s3_bucket_versioning.secure_bucket_versioning", "entity_tags": {}, "evaluations": null, "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}], "failed_checks": [{"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["block_public_policy", "resource_type", "block_public_acls"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type", "lifecycle_rule"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"secure_bucket": {"__end_line__": 40, "__start_line__": 29, "acl": ["private"], "bucket": ["lab-secure-bucket-${random_id.bucket_id.hex}"], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.mykey.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "__address__": "aws_s3_bucket.secure_bucket", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[29, "resource \"aws_s3_bucket\" \"secure_bucket\" {\n"], [30, "  bucket = \"lab-secure-bucket-${random_id.bucket_id.hex}\"\n"], [31, "  acl    = \"private\"\n"], [32, "  server_side_encryption_configuration {\n"], [33, "    rule {\n"], [34, "      apply_server_side_encryption_by_default {\n"], [35, "        kms_master_key_id = aws_kms_key.mykey.arn\n"], [36, "        sse_algorithm = \"aws:kms\"\n"], [37, "      }\n"], [38, "    }\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [29, 40], "resource": "aws_s3_bucket.secure_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/mangelmy/Desarrollo/DDS-V1-E1/DevSecOps/policy_as_code_labs/lab2-checkov/terraform/main.tf"}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 7, "failed": 5, "skipped": 0, "parsing_errors": 0, "resource_count": 3, "checkov_version": "3.2.473"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}